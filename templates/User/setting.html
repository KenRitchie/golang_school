<link rel="stylesheet" href="{$Think.config.CSS_URL}setting.css" type="text/css" />
<script type="text/javascript" src="{$Think.config.COMMON_URL}Js/uploadPreview.js"></script>
<div  class="container">


<div class='view-setting-view '>
	<div class="sub-view-box shadow">
		<div class="view-setting-profile-view">
			<h1>个人资料</h1>
			<ul class="setting-list">
				<li class="item">
				  <span class="title">头像</span>
				  <div class="avatar-uploader">
				  <form id="importModel" enctype="multipart/form-data">
				    <input type='file' name="headimg" class="input" style="display:none;" id="headimg-upd-btn" accept="image/jpg,image/png, image/jpeg" >
					
				 </form>
					<div id="headimg-upd-div">
					<if condition="mb_strlen($res['t_headimg']) lt 100">
					  <img src="{$res.t_headimg|substr=1}" width="80px" height="80px" id="headimg-upd-img">
					<else /> <img src="{$res.t_headimg}" width="80px" height="80px" id="headimg-upd-img">
					</if>
					</div>
					<div class="action-box">
					  <div class="hint">支持 jpg、png 格式大小 5M以内的照片</div>
					  <button class="upload-btn" onclick="openBrowse();">点击上传</button>
					  <button class="upload_btn" onclick="updHead();">保存</button>
					</div>
				  </div>
				</li>
				<script>
				$(function(){
					new uploadPreview({UpBtn:'headimg-upd-btn',DivShow:'headimg-upd-div',ImgShow:'headimg-upd-img'});
				
				})
				  function openBrowse(){
					$("input[name='headimg']").click()
					
				  }
				  function updHead(){
				    var user_id={$_SESSION[userid]};
					var headimg=$("input[name='headimg']").val();
					var formData = new FormData($("#importModel")[0]);
					$.ajax({
					  method:"POST",
					  url:"{:U('User/upd')}",
					  data:formData,
					  contentType: false, 
					  processData: false, 
					  success:function(res){
					    console.log(res)
					  }
					})
				  }
				  function upd(name){
				    
					var inputValue=$("input[name='"+name+"']").val();
					
					var  obj={}
					obj[name]=inputValue
					
					
					
					$.ajax({
					  method:"POST",
					  url:"{:U('User/upd')}",
					  data:obj,
					  success:function(res){
					    console.log(res)
					  }
					})
				  }
				
				</script>
				<li class="item">
				  <span class="title">用户名</span>
				  <div class="input-box profile-input profile-input">
				    <input spellcheck="false" class="input" placeholder="{$res.username}" disabled="disabled" style="background-color:#fff;">
					<div class="action-box">
					</div>
				  </div>
				</li>
				<li class="item">
				   <span class="title">职位</span>
				  <div class="input-box profile-input profile-input">
				    <input spellcheck="false" class="input" name="position" placeholder="请填写职业" value="{$res.position}">
					<div class="action-box">
					  <button tabindex="-1" class="btn " onclick="upd('position');">修改</button>
					</div>
				  </div>
				</li>
				<li class="item">
				   <span class="title">公司</span>
				  <div class="input-box profile-input profile-input">
				    <input spellcheck="false" class="input"  name="company" placeholder="请填写任职公司" value="{$res.company}">
					<div class="action-box">
					  <button tabindex="-1" class="btn" onclick="upd('company');">修改</button>
					</div>
				  </div>
				</li>
				<li class="item">
				   <span class="title">个人介绍</span>
				  <div class="input-box profile-input profile-input">
				    <input spellcheck="false" class="input" name="selfintroduction" placeholder="擅长的领域、兴趣、爱好等" value="{$res.selfintroduction}">
					<div class="action-box">
					  <button tabindex="-1" class="btn" onclick="upd('selfintroduction');">修改</button>
					</div>
				  </div>
				</li>
				<li class="item">
				   <span class="title">个人主页</span>
				  <div class="input-box profile-input profile-input">
				    <input spellcheck="false" class="input" name="homepage" placeholder="请填写个人主页"  value="{$res.homepage}">
					<div class="action-box">
					  <button tabindex="-1" class="btn"  onclick="upd('homepage');">修改</button>
					</div>
				  </div>
				</li>
			
			</ul>

		</div>
	</div>
</div>

</div>